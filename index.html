<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#0b1220">
  <title>SegnalaFacile ‚Äì Demo</title>

  <link rel="manifest" href="manifest.webmanifest">
  <link rel="icon" href="icon-192.png">
  <link rel="apple-touch-icon" href="icon-192.png">

  <style>
    :root{
      --bg:#0b1220;
      --card:#0f1b33;
      --text:#e8eefc;
      --muted:#a8b4d6;
      --accent:#2d7dff;
      --accent2:#19c37d;
      --danger:#ff4d4f;
      --stroke:rgba(255,255,255,.10);
      --r:18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      background:var(--bg);
      color:var(--text);
    }
    .wrap{max-width:860px;margin:0 auto;padding:20px 16px 90px}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px}
    .brand{display:flex;gap:10px;align-items:center}
    .logo{width:38px;height:38px;border-radius:12px;
      background:linear-gradient(135deg,#2d7dff,#19c37d)}
    .title{font-weight:800;font-size:18px}
    .badge{font-size:12px;color:var(--muted)}
    .grid{display:grid;gap:14px}
    .card{
      background:rgba(255,255,255,.05);
      border:1px solid var(--stroke);
      border-radius:var(--r);
      padding:16px;
    }
    .btnRow{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px}
    .btn,button{
      border:0;border-radius:14px;
      padding:12px 14px;
      font-weight:700;
      cursor:pointer;
      color:var(--text);
      background:rgba(255,255,255,.08);
    }
    .primary{background:var(--accent)}
    .danger{background:rgba(255,77,79,.18)}
    input,textarea{
      width:100%;padding:12px;
      border-radius:14px;
      border:1px solid var(--stroke);
      background:#0003;color:var(--text);
    }
    textarea{min-height:100px}
    .hidden{display:none}
    nav{
      position:fixed;bottom:0;left:0;right:0;
      background:#0b1220ee;
      border-top:1px solid var(--stroke);
    }
    nav .inner{
      max-width:860px;margin:0 auto;
      display:flex;justify-content:space-around;
      padding:10px;
    }
    nav a{color:var(--muted);text-decoration:none;font-size:12px}
    nav a.active{color:var(--text)}
  </style>
</head>

<body>

<div class="wrap">
  <header>
    <div class="brand">
      <div class="logo"></div>
      <div>
        <div class="title">SegnalaFacile</div>
        <div class="badge">DEMO ‚Ä¢ Telegram integrato</div>
      </div>
    </div>
  </header>

  <!-- HOME -->
  <section id="home" class="grid">
    <div class="card">
      <h2>Invia una segnalazione</h2>
      <p class="badge">Verr√† inoltrata anche su Telegram</p>
      <div class="btnRow">
        <a class="btn primary" href="#report">üìù Segnala</a>
      </div>
    </div>
  </section>

  <!-- REPORT -->
  <section id="report" class="grid hidden">
    <div class="card">
      <label>Titolo</label>
      <input id="titolo">

      <label>Descrizione</label>
      <textarea id="descrizione"></textarea>

      <label>
        <input type="checkbox" id="anonimo"> Invia anonimo
      </label>

      <div class="btnRow">
        <button class="primary" id="btnSend">Invia</button>
      </div>
    </div>
  </section>

  <!-- SUCCESS -->
  <section id="success" class="grid hidden">
    <div class="card">
      <h2>‚úÖ Segnalazione inviata</h2>
      <a class="btn" href="#">Torna alla home</a>
    </div>
  </section>
</div>

<nav>
  <div class="inner">
    <a href="#" data-view="home" class="active">Home</a>
    <a href="#report" data-view="report">Segnala</a>
  </div>
</nav>

<script>
/* CONFIG */
const CONFIG = {
  telegramWorkerUrl: "https://segnalafacile-telegram.vocidicassino.workers.dev",
  telegramApiKey: "Marco-Admin-2026"
};

/* ROUTER */
const views = ["home","report","success"];
function show(v){
  views.forEach(id=>{
    document.getElementById(id).classList.toggle("hidden", id!==v);
  });
  document.querySelectorAll("nav a").forEach(a=>{
    a.classList.toggle("active", a.dataset.view===v);
  });
}
window.addEventListener("hashchange", ()=>{
  const v = location.hash.replace("#","") || "home";
  show(v);
});
show("home");

/* INVIO */
document.getElementById("btnSend").addEventListener("click", async ()=>{
  const titolo = titolo.value.trim();
  const descrizione = descrizione.value.trim();
  if(!titolo || !descrizione){ alert("Compila tutti i campi"); return; }

  await fetch(CONFIG.telegramWorkerUrl,{
    method:"POST",
    headers:{
      "Content-Type":"application/json",
      "X-Api-Key": CONFIG.telegramApiKey
    },
    body: JSON.stringify({
      titolo,
      descrizione,
      anonimo: anonimo.checked,
      when: new Date().toLocaleString("it-IT"),
      hasPhoto:false
    })
  });

  location.hash="#success";
});
</script>

</body>
</html>
